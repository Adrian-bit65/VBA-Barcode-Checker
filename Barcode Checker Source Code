' This is a function used to compare barcodes for batches that are scanned in on the Hamilton with a list pasted in from the batch list on Epic.
' First, paste in the barcodes from the Excel file that the Hamilton makes on the green box in column C
' Second, paste in the list from the snapshot of the batch (clicking and dragging from "1." to the end of "COVID.DL") on the green box in column D
' Lastly, go to the Developer tab and hit "Macros" on the left-hand side, select "barcodeListandCheck", then hit Run

Sub barcodeListandCheck()
Dim X As Integer
Dim N As Integer
N = 3
' In this For Loop, we are looking through the 92 potential spots from the batch list and pulling the Accession numbers using the criteria that they are above 100
' Numbers that are above 100, which are often the Accession numbers we are trying to compare, are pulled from column D and put in column G.
    For X = 2 To 93
    Set ahsNumbeR = Range("G" & X)
    Set numberPicker = Range("D" & N)
        If numberPicker > 100 Then
            ahsNumbeR.Value = numberPicker
        End If
    N = N + 5
    Next X
    ' In this For Loop, we compare the barcodes pulled from the batch list (column G) with the barcodes scanned in from the Hamilton (column C)
    ' For every 92 potential spots, it will check if there are barcodes and if there are, it will then check if they match. A message is printed according to the outcome.
    For I = 2 To 93
    Set patientName = Range("A" & I)
    Set matchCheck = Range("B" & I)
    Set scannedBarcodes = Range("C" & I)
    Set pastedBarcodes = Range("G" & I)
    Dim J As Integer
    J = I - 1
        If scannedBarcodes = Range("F" & I) Then
            patientName.Value = "No Patient " & J
            matchCheck.Value = "No Barcode"
        ElseIf scannedBarcodes = pastedBarcodes Then
            patientName.Value = "Patient " & J
            matchCheck.Value = "Barcodes match"
            Range("A" & I).Interior.ColorIndex = 4
        ElseIf scannedBarcodes <> pastedBarcodes Then
            patientName.Value = "Patient " & J
            matchCheck.Value = "DOES NOT MATCH"
            Range("A" & I).Interior.ColorIndex = 3
        End If
    Next I
End Sub
